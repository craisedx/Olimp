@model List<Olimp.ViewModels.Basket.BasketStoreWarehouseViewModel>

<div class="container">
    @{ double totalAmount = 0; }
    @foreach (var item in @Model)
    {
        {
            if (item.StoreWarehouse.Discount == 0)
            {
                totalAmount += item.Quantity * item.StoreWarehouse.Price;
            }
            else
            {
                totalAmount += Math.Round(item.StoreWarehouse.Price - item.StoreWarehouse.Price * (item.StoreWarehouse.Discount / 100.00), 2) * item.Quantity;
            }
        }
        <div class="row mt-5 border-bottom pb-3">
            <div class="col-lg-2">
                <img src="@item.StoreWarehouse.Product.Image" alt="product" style="height: 150px;width: 150px;"/>
            </div>
            <div class="col-lg-4">
                <div class="h5">
                    <a asp-action="Product" asp-controller="Product" asp-route-id="@item.StoreWarehouse.Id">@item.StoreWarehouse.Product.Title</a>
                </div>
                <div>Бренд : @item.StoreWarehouse.Product.Brand.ProductBrand</div>
                <div>Категория : @item.StoreWarehouse.Product.Category.ProductCategory</div>
                <div>Количесво : @item.Quantity шт</div>
                @if (item.StoreWarehouse.Discount == 0)
                {
                    <div>Стоимость : @(item.StoreWarehouse.Price) BYN</div>
                }
                else
                {
                    <div>Стоимость : @(Math.Round(item.StoreWarehouse.Price - item.StoreWarehouse.Price * (item.StoreWarehouse.Discount / 100.00), 2)) BYN</div>
                }
            </div>
            <div class="col-lg-5 d-flex justify-content-end align-items-start">
                <a class="btn btn-danger" asp-action="DeleteProductInBasket" asp-controller="Product" asp-route-id="@item.StoreWarehouse.Id" asp-route-userId="@User.Claims.ElementAt(0).Value">Удалить</a>
            </div>
        </div>
    }
    <div class="row mt-3">
        <div class="col-lg-12 d-flex justify-content-start align-items-baseline">
            <p>Итоговая сумма : </p>
            <p class="text-success h3 ml-2">@totalAmount</p>
            <div class="h4 ml-1">BYN</div>
        </div>
        <div class="col-lg-12 d-flex justify-content-start align-items-start">
            <form method="post" asp-controller="Product" asp-action="AddOrder">
                <div class="input-group d-flex justify-content-end align-items-baseline">
                    <p class="mr-2">Адрес самовывоза: </p>
                    <select class="custom-select" id="inputGroupSelect01" name="address">
                        @foreach (var address in ViewBag.Address)
                        {
                            <option value="@address">@address</option>
                        }
                    </select>
                </div>
                <input type="hidden" name="userId" value="@User.Claims.ElementAt(0).Value"/>
                @if (Model.Count > 0)
                {
                    <button type="submit" class="btn btn-primary">Оформить заказ</button>
                }
            </form>
        </div>
    </div>
</div>